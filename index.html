<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CloudHost - Discord Bot Hosting</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        [x-cloak] { display: none !important; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }
    </style>
</head>
<body class="bg-slate-950 text-slate-100 font-sans antialiased" x-data="cloudHostApp()" x-cloak>

    <!-- Sidebar -->
    <nav class="fixed left-0 top-0 h-full w-64 bg-slate-900 border-r border-slate-800 flex flex-col p-4 z-50">
        <div class="flex items-center gap-3 mb-10 px-2">
            <div class="bg-sky-600 p-2 rounded-lg shadow-lg shadow-sky-500/20">
                <i class="fas fa-cloud text-white text-xl"></i>
            </div>
            <h1 class="font-bold text-xl tracking-tight">CloudHost</h1>
        </div>

        <div class="space-y-2 flex-grow">
            <button @click="view = 'dashboard'" :class="view === 'dashboard' ? 'bg-sky-600/20 text-sky-400 border border-sky-500/30' : 'hover:bg-slate-800 text-slate-400 hover:text-white'" class="w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all">
                <i class="fas fa-chart-line w-5"></i> Dashboard
            </button>
            <button @click="view = 'deploy'" :class="view === 'deploy' ? 'bg-sky-600/20 text-sky-400 border border-sky-500/30' : 'hover:bg-slate-800 text-slate-400 hover:text-white'" class="w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all">
                <i class="fab fa-github w-5"></i> Deploy GitHub
            </button>
            <button @click="view = 'settings'" :class="view === 'settings' ? 'bg-sky-600/20 text-sky-400 border border-sky-500/30' : 'hover:bg-slate-800 text-slate-400 hover:text-white'" class="w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all">
                <i class="fas fa-cog w-5"></i> Settings
            </button>
        </div>

        <div class="p-4 bg-slate-800/50 rounded-xl border border-slate-700 mt-auto">
            <p class="text-[10px] text-slate-500 uppercase font-bold mb-2 tracking-wider">System Info</p>
            <p class="text-xs font-medium flex items-center gap-2">
                <i class="fas fa-server text-sky-400"></i> Node.js v20.x
            </p>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="ml-64 p-8 max-w-6xl mx-auto">
        
        <!-- DASHBOARD VIEW -->
        <template x-if="view === 'dashboard'">
            <div class="space-y-6">
                <div class="flex justify-between items-end">
                    <div>
                        <h2 class="text-3xl font-bold tracking-tight">Instance Overview</h2>
                        <p class="text-slate-400">Monitoring your deployed bot process.</p>
                    </div>
                    <div class="flex gap-3">
                        <template x-if="status === 'online'">
                            <button @click="stopBot" class="bg-rose-600 hover:bg-rose-700 px-5 py-2.5 rounded-lg font-bold transition shadow-lg shadow-rose-900/20">
                                <i class="fas fa-stop mr-2"></i> Stop Bot
                            </button>
                        </template>
                        <template x-if="status !== 'online'">
                            <button @click="startDeployment" :disabled="status === 'building'" class="bg-sky-600 hover:bg-sky-700 disabled:opacity-50 px-5 py-2.5 rounded-lg font-bold transition shadow-lg shadow-sky-900/20">
                                <i class="fas fa-play mr-2"></i> Run Bot
                            </button>
                        </template>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Bot Interaction Console -->
                    <div class="bg-slate-900 rounded-2xl border border-slate-800 flex flex-col shadow-xl overflow-hidden">
                        <div class="bg-slate-800/50 p-4 border-b border-slate-700 flex justify-between items-center">
                            <span class="text-sm font-bold flex items-center gap-2">
                                <i class="fas fa-terminal text-sky-400"></i> Bot Interaction
                            </span>
                            <div class="flex items-center gap-2">
                                <div :class="status === 'online' ? 'bg-emerald-500 animate-pulse' : 'bg-slate-600'" class="w-2 h-2 rounded-full"></div>
                                <span class="text-[10px] uppercase font-bold text-slate-400" x-text="status"></span>
                            </div>
                        </div>
                        <div class="p-4 flex-grow h-[350px] overflow-y-auto space-y-4 text-sm" id="chat-box">
                            <template x-if="chatMessages.length === 0">
                                <div class="text-slate-500 text-center mt-10">
                                    <i class="fas fa-code mb-2 block text-2xl"></i>
                                    <p>Deploy your bot and use your custom variables.</p>
                                </div>
                            </template>
                            <template x-for="msg in chatMessages" :key="msg.id">
                                <div :class="msg.role === 'user' ? 'text-right' : 'text-left'">
                                    <div :class="msg.role === 'user' ? 'bg-sky-600 text-white ml-auto' : 'bg-slate-800 text-slate-200'" class="inline-block px-4 py-2 rounded-2xl max-w-[85%]">
                                        <p x-text="msg.text"></p>
                                    </div>
                                    <p class="text-[10px] mt-1 text-slate-500" x-text="msg.role === 'user' ? 'Admin' : (getEnv('BOT_NAME') || 'System')"></p>
                                </div>
                            </template>
                        </div>
                        <div class="p-4 bg-slate-800/30 border-t border-slate-700">
                            <form @submit.prevent="sendMessage" class="flex gap-2">
                                <input 
                                    type="text" 
                                    x-model="userInput" 
                                    :disabled="status !== 'online'"
                                    placeholder="Type a message to trigger bot logic..." 
                                    class="flex-grow bg-slate-950 border border-slate-700 rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-sky-500 disabled:opacity-50"
                                >
                                <button type="submit" :disabled="status !== 'online'" class="bg-sky-600 p-2 px-4 rounded-xl hover:bg-sky-700 disabled:opacity-50">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </form>
                        </div>
                    </div>

                    <!-- Runtime Logs -->
                    <div class="bg-[#0b0e14] rounded-2xl border border-slate-800 overflow-hidden flex flex-col shadow-2xl h-[500px]">
                        <div class="bg-slate-800/80 px-4 py-2.5 flex items-center justify-between border-b border-slate-700/50">
                            <span class="text-xs font-mono text-slate-300">cloudhost_runtime ~ logs</span>
                            <button @click="logs = []" class="text-xs text-slate-400 hover:text-white"><i class="fas fa-eraser"></i></button>
                        </div>
                        <div class="p-4 font-mono text-[11px] overflow-y-auto flex-grow" id="terminal">
                            <template x-for="log in logs" :key="log.id">
                                <div class="mb-1">
                                    <span class="text-slate-600" x-text="log.time"></span> 
                                    <span :class="log.type === 'error' ? 'text-rose-400' : 'text-sky-400/80'" x-text="log.text"></span>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
            </div>
        </template>

        <!-- DEPLOY VIEW -->
        <template x-if="view === 'deploy'">
            <div class="max-w-2xl space-y-8">
                <div>
                    <h2 class="text-3xl font-bold">Cloud Deployment</h2>
                    <p class="text-slate-400">Configure your bot's environment and source code.</p>
                </div>
                
                <div class="bg-slate-900 p-6 rounded-2xl border border-slate-800 space-y-6">
                    <div>
                        <label class="block text-sm font-bold text-slate-400 mb-2">GitHub Repository</label>
                        <input x-model="repoUrl" type="text" placeholder="https://github.com/user/my-bot" class="w-full bg-slate-950 border border-slate-700 rounded-xl p-3 focus:ring-2 focus:ring-sky-500 outline-none">
                    </div>
                    
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <label class="block text-sm font-bold text-slate-400">Environment Variables (.env)</label>
                            <button @click="addEnvVar" class="text-xs text-sky-400 hover:text-sky-300 font-bold"><i class="fas fa-plus mr-1"></i> Add Variable</button>
                        </div>
                        <div class="space-y-3">
                            <template x-for="(env, index) in envVars" :key="index">
                                <div class="flex gap-2">
                                    <input x-model="env.key" type="text" placeholder="KEY" class="w-1/3 bg-slate-950 border border-slate-700 rounded-lg p-2 text-xs font-mono">
                                    <input x-model="env.value" type="text" placeholder="VALUE" class="w-full bg-slate-950 border border-slate-700 rounded-lg p-2 text-xs font-mono">
                                    <button @click="removeEnvVar(index)" class="text-slate-500 hover:text-rose-500 px-1"><i class="fas fa-times"></i></button>
                                </div>
                            </template>
                        </div>
                    </div>

                    <div class="pt-4 border-t border-slate-800">
                        <button @click="view = 'dashboard'; startDeployment();" class="w-full bg-sky-600 hover:bg-sky-700 py-4 rounded-xl font-bold shadow-lg transition-transform active:scale-95">
                            Apply Changes & Deploy
                        </button>
                    </div>
                </div>
            </div>
        </template>

        <!-- SETTINGS VIEW -->
        <template x-if="view === 'settings'">
            <div class="max-w-2xl space-y-8">
                <h2 class="text-3xl font-bold tracking-tight">System Settings</h2>
                <div class="bg-slate-900 rounded-2xl border border-slate-800 p-6 space-y-4">
                    <div class="flex justify-between items-center">
                        <span class="font-medium">Auto-Restart on Crash</span>
                        <div class="w-10 h-5 bg-sky-600 rounded-full relative">
                            <div class="w-3 h-3 bg-white rounded-full absolute right-1 top-1"></div>
                        </div>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="font-medium">Verbose Logging</span>
                        <div class="w-10 h-5 bg-slate-700 rounded-full relative">
                            <div class="w-3 h-3 bg-slate-400 rounded-full absolute left-1 top-1"></div>
                        </div>
                    </div>
                </div>
            </div>
        </template>
    </main>

    <script>
        function cloudHostApp() {
            return {
                view: 'dashboard',
                status: 'offline',
                repoUrl: 'https://github.com/cloudhost/discord-js-bot',
                logs: [],
                chatMessages: [],
                userInput: '',
                envVars: [
                    { key: 'BOT_NAME', value: 'SkyBot' },
                    { key: 'PREFIX', value: '!' },
                    { key: 'DISCORD_TOKEN', value: 'MTA4NDI...' }
                ],

                addLog(text, type = 'info') {
                    this.logs.push({ 
                        id: Date.now() + Math.random(), 
                        time: new Date().toLocaleTimeString([], { hour12: false }), 
                        text: text,
                        type: type
                    });
                    this.$nextTick(() => {
                        const el = document.getElementById('terminal');
                        if (el) el.scrollTop = el.scrollHeight;
                    });
                },

                getEnv(key) {
                    const found = this.envVars.find(e => e.key === key);
                    return found ? found.value : null;
                },

                addEnvVar() {
                    this.envVars.push({ key: '', value: '' });
                },

                removeEnvVar(index) {
                    this.envVars.splice(index, 1);
                },

                startDeployment() {
                    this.status = 'building';
                    this.logs = [];
                    this.addLog(">>> Starting deployment process...");
                    
                    const steps = [
                        { msg: "Fetching repository: " + this.repoUrl, delay: 600 },
                        { msg: "Loading environment variables...", delay: 1000 },
                        { msg: "Detected " + this.envVars.length + " secrets in .env", delay: 1200 },
                        { msg: "Installing dependencies (npm install)...", delay: 2000 },
                        { msg: "Building production bundle...", delay: 2800 },
                        { msg: "Process started: bot.js (PID 8821)", delay: 3500 },
                        { msg: "Bot: " + (this.getEnv('BOT_NAME') || 'Unknown') + " is now online.", delay: 3800 }
                    ];

                    steps.forEach(step => {
                        setTimeout(() => {
                            this.addLog(step.msg);
                            if (step.msg.includes("online")) {
                                this.status = 'online';
                            }
                        }, step.delay);
                    });
                },

                stopBot() {
                    this.status = 'offline';
                    this.addLog("Received shutdown signal.", "info");
                    this.addLog("Process exited with code 0", "info");
                },

                sendMessage() {
                    if (!this.userInput.trim() || this.status !== 'online') return;

                    const text = this.userInput;
                    this.userInput = '';
                    this.chatMessages.push({ id: Date.now(), role: 'user', text: text });
                    this.addLog(`[COMMAND] Executing: ${text}`);

                    // Logic using custom variables
                    const botName = this.getEnv('BOT_NAME') || 'Bot';
                    const prefix = this.getEnv('PREFIX') || '';

                    setTimeout(() => {
                        let response = "I'm running your custom code! (PID 8821)";
                        
                        if (text.toLowerCase().includes('hello')) {
                            response = `Hello! I am ${botName}. How can I help?`;
                        } else if (text.startsWith(prefix)) {
                            response = `Command detected with prefix "${prefix}"`;
                        }

                        this.chatMessages.push({ id: Date.now() + 1, role: 'bot', text: response });
                        this.addLog(`[RESPONSE] ${botName}: ${response}`);
                        
                        this.$nextTick(() => {
                            const el = document.getElementById('chat-box');
                            if (el) el.scrollTop = el.scrollHeight;
                        });
                    }, 500);
                }
            }
        }
    </script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
</body>
</html>
