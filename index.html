<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CloudHost - Discord Bot Hosting</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        [x-cloak] { display: none !important; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }
    </style>
</head>
<body class="bg-slate-950 text-slate-100 font-sans antialiased" x-data="cloudHostApp()" x-cloak>

    <!-- Sidebar -->
    <nav class="fixed left-0 top-0 h-full w-64 bg-slate-900 border-r border-slate-800 flex flex-col p-4 z-50">
        <div class="flex items-center gap-3 mb-10 px-2">
            <div class="bg-sky-600 p-2 rounded-lg shadow-lg shadow-sky-500/20">
                <i class="fas fa-cloud text-white text-xl"></i>
            </div>
            <h1 class="font-bold text-xl tracking-tight">CloudHost</h1>
        </div>

        <div class="space-y-2 flex-grow">
            <button 
                @click="view = 'dashboard'"
                :class="view === 'dashboard' ? 'bg-sky-600/20 text-sky-400 border border-sky-500/30' : 'hover:bg-slate-800 text-slate-400 hover:text-white'"
                class="w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all"
            >
                <i class="fas fa-chart-line w-5"></i> Dashboard
            </button>
            <button 
                @click="view = 'deploy'"
                :class="view === 'deploy' ? 'bg-sky-600/20 text-sky-400 border border-sky-500/30' : 'hover:bg-slate-800 text-slate-400 hover:text-white'"
                class="w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all"
            >
                <i class="fab fa-github w-5"></i> Deploy GitHub
            </button>
            <button 
                @click="view = 'settings'"
                :class="view === 'settings' ? 'bg-sky-600/20 text-sky-400 border border-sky-500/30' : 'hover:bg-slate-800 text-slate-400 hover:text-white'"
                class="w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all"
            >
                <i class="fas fa-cog w-5"></i> Settings
            </button>
        </div>

        <div class="p-4 bg-slate-800/50 rounded-xl border border-slate-700">
            <div class="flex justify-between items-center mb-2">
                <span class="text-xs text-slate-400 uppercase font-bold text-[10px]">Region</span>
                <span class="text-[10px] bg-emerald-500/20 text-emerald-400 px-2 py-0.5 rounded border border-emerald-500/30 font-bold">US-EAST-1</span>
            </div>
            <p class="text-xs font-medium flex items-center gap-2">
                <i class="fas fa-server text-sky-400"></i> Instance: c4-micro
            </p>
            <div class="w-full bg-slate-700 h-1.5 rounded-full mt-3 overflow-hidden">
                <div class="bg-sky-500 h-full w-2/3"></div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="ml-64 p-8 max-w-6xl mx-auto">
        
        <!-- DASHBOARD VIEW -->
        <template x-if="view === 'dashboard'">
            <div class="space-y-6">
                <div class="flex justify-between items-end">
                    <div>
                        <h2 class="text-3xl font-bold tracking-tight">Instance Overview</h2>
                        <p class="text-slate-400">Monitoring your cloud-hosted bot.</p>
                    </div>
                    <div class="flex gap-3">
                        <template x-if="status === 'online'">
                            <button @click="stopBot" class="flex items-center gap-2 bg-rose-600 hover:bg-rose-700 px-5 py-2.5 rounded-lg font-bold transition shadow-lg shadow-rose-900/20">
                                <i class="fas fa-stop"></i> Stop Instance
                            </button>
                        </template>
                        <template x-if="status !== 'online'">
                            <button 
                                @click="startDeployment" 
                                :disabled="status === 'building'"
                                class="flex items-center gap-2 bg-sky-600 hover:bg-sky-700 disabled:opacity-50 px-5 py-2.5 rounded-lg font-bold transition shadow-lg shadow-sky-900/20"
                            >
                                <i class="fas fa-bolt" :class="status === 'building' ? 'animate-bounce' : ''"></i> 
                                <span x-text="status === 'building' ? 'Deploying...' : 'Deploy Now'"></span>
                            </button>
                        </template>
                    </div>
                </div>

                <!-- Status Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-slate-900 p-6 rounded-2xl border border-slate-800 shadow-xl group hover:border-sky-500/30 transition-colors">
                        <div class="flex items-center gap-3 mb-4">
                            <div :class="status === 'online' ? 'bg-emerald-500 shadow-[0_0_12px_#10b981] animate-pulse' : status === 'building' ? 'bg-amber-500 animate-pulse' : 'bg-rose-500'" class="w-3 h-3 rounded-full"></div>
                            <span class="font-bold text-slate-300 text-sm">Operational Status</span>
                        </div>
                        <p class="text-3xl font-bold capitalize tracking-tight" x-text="status"></p>
                    </div>
                    <div class="bg-slate-900 p-6 rounded-2xl border border-slate-800 shadow-xl group hover:border-sky-500/30 transition-colors">
                        <div class="flex items-center gap-3 mb-4 text-sky-400">
                            <i class="fas fa-microchip text-lg"></i>
                            <span class="font-bold text-slate-300 text-sm">CPU Load</span>
                        </div>
                        <p class="text-3xl font-bold tracking-tight" x-text="status === 'online' ? '8.4%' : '0%'"></p>
                    </div>
                    <div class="bg-slate-900 p-6 rounded-2xl border border-slate-800 shadow-xl group hover:border-sky-500/30 transition-colors">
                        <div class="flex items-center gap-3 mb-4 text-emerald-400">
                            <i class="fas fa-clock text-lg"></i>
                            <span class="font-bold text-slate-300 text-sm">Live Uptime</span>
                        </div>
                        <p class="text-3xl font-bold tracking-tight" x-text="status === 'online' ? uptime : '--:--:--'"></p>
                    </div>
                </div>

                <!-- Terminal View -->
                <div class="bg-[#0b0e14] rounded-2xl border border-slate-800 overflow-hidden flex flex-col shadow-2xl h-[450px]">
                    <div class="bg-slate-800/80 px-4 py-2.5 flex items-center justify-between border-b border-slate-700/50 backdrop-blur-sm">
                        <div class="flex items-center gap-2">
                            <i class="fas fa-terminal text-sky-400 text-sm"></i>
                            <span class="text-xs font-mono text-slate-300">cloudhost_shell ~ logs</span>
                        </div>
                        <button @click="logs = []" class="text-xs text-slate-400 hover:text-white flex items-center gap-1 transition">
                            <i class="fas fa-sync-alt text-[10px]"></i> Clear Console
                        </button>
                    </div>
                    <div class="p-5 font-mono text-[13px] overflow-y-auto flex-grow scroll-smooth" id="terminal">
                        <template x-if="logs.length === 0">
                            <p class="text-slate-600 italic">No activity detected. CloudHost is ready for deployment.</p>
                        </template>
                        <template x-for="log in logs" :key="log.id">
                            <div class="mb-1 text-sky-400/90 leading-relaxed">
                                <span class="text-slate-700 mr-2">âžœ</span> <span x-text="log.text"></span>
                            </div>
                        </template>
                        <template x-if="status === 'building'">
                            <div class="animate-pulse text-sky-400 inline-block w-2 h-4 bg-sky-400 ml-1"></div>
                        </template>
                    </div>
                </div>
            </div>
        </template>

        <!-- DEPLOY VIEW -->
        <template x-if="view === 'deploy'">
            <div class="max-w-2xl space-y-8">
                <div>
                    <h2 class="text-3xl font-bold tracking-tight">Cloud Deployment</h2>
                    <p class="text-slate-400">Connect your source and configure runtime secrets.</p>
                </div>

                <div class="space-y-6">
                    <div class="space-y-2">
                        <label class="text-sm font-semibold text-slate-300">GitHub Repository Source</label>
                        <div class="relative">
                            <i class="fab fa-github absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 text-lg"></i>
                            <input 
                                type="text" 
                                x-model="repoUrl"
                                placeholder="https://github.com/cloud-dev/discord-bot"
                                class="w-full bg-slate-900 border border-slate-800 rounded-xl py-3 pl-11 pr-4 focus:outline-none focus:ring-2 focus:ring-sky-500 transition shadow-inner"
                            />
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div class="flex justify-between items-center">
                            <label class="text-sm font-semibold text-slate-300">Cloud Secrets (.env)</label>
                            <button 
                                @click="addEnvVar"
                                class="text-xs font-bold flex items-center gap-1 text-sky-400 hover:text-sky-300 transition"
                            >
                                <i class="fas fa-plus"></i> Add Secret
                            </button>
                        </div>
                        
                        <div class="space-y-3">
                            <template x-for="(env, index) in envVars" :key="index">
                                <div class="flex gap-3">
                                    <input 
                                        type="text" 
                                        placeholder="SECRET_KEY"
                                        x-model="env.key"
                                        class="flex-1 bg-slate-900 border border-slate-800 rounded-lg py-2.5 px-3 text-sm font-mono focus:outline-none focus:border-sky-500"
                                    />
                                    <input 
                                        type="password" 
                                        placeholder="VALUE"
                                        x-model="env.value"
                                        class="flex-1 bg-slate-900 border border-slate-800 rounded-lg py-2.5 px-3 text-sm font-mono focus:outline-none focus:border-sky-500"
                                    />
                                    <button @click="removeEnvVar(index)" class="text-slate-600 hover:text-rose-500 transition px-2">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </template>
                        </div>
                    </div>

                    <div class="pt-4 border-t border-slate-800">
                        <button 
                            @click="view = 'dashboard'; startDeployment();"
                            class="w-full bg-sky-600 hover:bg-sky-700 py-4 rounded-xl font-bold shadow-lg shadow-sky-500/20 transition-all active:scale-[0.98] flex items-center justify-center gap-3"
                        >
                            <i class="fas fa-cloud-upload-alt"></i> Provision and Deploy
                        </button>
                    </div>
                </div>
            </div>
        </template>

        <!-- SETTINGS VIEW -->
        <template x-if="view === 'settings'">
            <div class="max-w-2xl space-y-8">
                <div>
                    <h2 class="text-3xl font-bold tracking-tight">Cloud Settings</h2>
                    <p class="text-slate-400">Global preferences for your CloudHost infrastructure.</p>
                </div>
                
                <div class="bg-slate-900 rounded-2xl border border-slate-800 divide-y divide-slate-800 overflow-hidden shadow-xl">
                    <div class="p-6 flex justify-between items-center">
                        <div>
                            <h4 class="font-semibold">Automated Self-Healing</h4>
                            <p class="text-xs text-slate-400">Automatically reboot instance on runtime errors.</p>
                        </div>
                        <div class="w-12 h-6 bg-sky-600 rounded-full flex items-center justify-end px-1 cursor-pointer">
                            <div class="w-4 h-4 bg-white rounded-full"></div>
                        </div>
                    </div>
                    <div class="p-6 flex justify-between items-center">
                        <div>
                            <h4 class="font-semibold">GitHub CI/CD Sync</h4>
                            <p class="text-xs text-slate-400">Trigger rolling update on repo push.</p>
                        </div>
                        <div class="w-12 h-6 bg-slate-700 rounded-full flex items-center justify-start px-1 cursor-pointer">
                            <div class="w-4 h-4 bg-slate-400 rounded-full"></div>
                        </div>
                    </div>
                    <div class="p-6">
                        <h4 class="font-semibold text-rose-400 mb-2">Management</h4>
                        <button class="flex items-center gap-2 text-xs border border-rose-500/30 bg-rose-500/10 text-rose-500 px-4 py-2.5 rounded-lg hover:bg-rose-500 hover:text-white transition font-bold">
                            <i class="fas fa-trash-alt"></i> Destroy Deployment
                        </button>
                    </div>
                </div>
            </div>
        </template>

    </main>

    <script>
        function cloudHostApp() {
            return {
                view: 'dashboard',
                status: 'offline',
                repoUrl: '',
                envVars: [{ key: 'DISCORD_TOKEN', value: '' }],
                logs: [],
                uptime: '00:00:00',
                uptimeTimer: null,

                addEnvVar() {
                    this.envVars.push({ key: '', value: '' });
                },

                removeEnvVar(index) {
                    this.envVars.splice(index, 1);
                },

                startDeployment() {
                    if (!this.repoUrl) {
                        alert("Error: Please provide a valid GitHub Repository URL in the Deployment tab.");
                        return;
                    }

                    this.status = 'building';
                    this.logs = [];
                    
                    const deploymentSteps = [
                        "Initializing CloudHost provisioner...",
                        "Allocating virtual resources (c4-micro)...",
                        "Securing network gateway...",
                        "Connecting to GitHub API v3...",
                        "Cloning repository: " + this.repoUrl,
                        "Analyzing workspace: detected Node.js environment.",
                        "Caching system dependencies...",
                        "Running: npm install --production",
                        "Setting up secure environment tunnel...",
                        "Generating runtime manifest...",
                        "Starting bot process...",
                        "Handshake successful: Discord Gateway connected!",
                        "CloudHost deployment complete. Instance is now LIVE."
                    ];

                    deploymentSteps.forEach((step, index) => {
                        setTimeout(() => {
                            this.logs.push({ id: Date.now() + index, text: `[${new Date().toLocaleTimeString()}] ${step}` });
                            this.$nextTick(() => {
                                const el = document.getElementById('terminal');
                                if (el) el.scrollTop = el.scrollHeight;
                            });

                            if (index === deploymentSteps.length - 1) {
                                this.status = 'online';
                                this.startUptime();
                            }
                        }, (index + 1) * 1100);
                    });
                },

                stopBot() {
                    this.status = 'offline';
                    clearInterval(this.uptimeTimer);
                    this.uptime = '00:00:00';
                    this.logs.push({ id: Date.now(), text: `[${new Date().toLocaleTimeString()}] SYSTEM: Instance shutdown requested. Termination complete.` });
                },

                startUptime() {
                    let seconds = 0;
                    clearInterval(this.uptimeTimer);
                    this.uptimeTimer = setInterval(() => {
                        seconds++;
                        const hrs = String(Math.floor(seconds / 3600)).padStart(2, '0');
                        const mins = String(Math.floor((seconds % 3600) / 60)).padStart(2, '0');
                        const secs = String(seconds % 60).padStart(2, '0');
                        this.uptime = `${hrs}:${mins}:${secs}`;
                    }, 1000);
                }
            }
        }
    </script>
    <!-- Alpine.js script placed at the end of body to ensure cloudHostApp is defined first -->
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
</body>
</html>
